/*! gmap.js 12-06-2016 */
!function(a,b){function c(b){function e(a){var b=this,c=new google.maps.DirectionsRenderer,d=new google.maps.DirectionsService;c.setMap(this.moveOptions.mapName),this.moveOptions.directionsDisplay=c,this.moveOptions.directionsService=d;var e={origin:"",destination:"",travelMode:"",avoidFerries:"",avoidHighways:"",avoidTolls:"",durationInTraffic:"",optimizeWaypoints:"",provideRouteAlternatives:"",unitSystem:google.maps.UnitSystem.METRIC,waypoints:"",autoDraw:!0,success:function(){}},a=o.fn.extendMine(e,a);if(b.options=a,!c)throw"'DirectionsRenderer' load failed ,you must load function of 'Direction' first ";if(!d)throw"'directionsService' load failed,you must load function of 'Direction' first ";if(!a.origin)throw"you must set the origin!";if(!a.destination)throw"you must set the destination!";if(!a.travelMode)throw'you must set the travelMode,include:"driving,bicycling,transit,walking"!';var f=a.travelMode.toUpperCase();a.travelMode=google.maps.TravelMode[f],a.origin=o.fn.common.makeGoogleLag(a.origin),a.destination=o.fn.common.makeGoogleLag(a.destination),a.suppressMarkers!==!0&&a.suppressMarkers!==!1||c.setOptions({suppressMarkers:a.suppressMarkers}),a.strokeColor&&c.setOptions({polylineOptions:{strokeColor:a.strokeColor}});var g={origin:a.origin,destination:a.destination,travelMode:a.travelMode,provideRouteAlternatives:!0};a.avoidFerries&&(g.avoidFerries=a.avoidFerries),a.avoidHighways&&(g.avoidHighways=a.avoidHighways),a.avoidTolls&&(g.avoidTolls=a.avoidTolls),a.durationInTraffic&&(g.durationInTraffic=a.durationInTraffic),a.optimizeWaypoints&&(g.optimizeWaypoints=a.optimizeWaypoints),a.provideRouteAlternatives&&(g.provideRouteAlternatives=a.provideRouteAlternatives),a.waypoints&&(g.waypoints=a.waypoints),g.unitSystem=a.unitSystem,d.route(g,function(d,e){if(e!=google.maps.DirectionsStatus.OK)throw"Directions request failed due to"+e;b.options.autoDraw&&c.setDirections(d),b.moveOptions.response||(b.moveOptions.response=d);var f=d.routes,h=[];o.fn.each(f,function(a,b){var c=[];o.fn.each(b.legs[0].steps,function(a,b){c.push(b.instructions)});var d={duration:b.legs[0].duration.text,distance:b.legs[0].distance.text,step:c,route:b,type:g.travelMode};h.push(d)}),b.moveOptions.directionsInformation=h,a.success.call(this,b.moveOptions.directionsInformation)})}var g=this;if(!(this instanceof c))return new c(b);this.moveOptions={markerArray:[],infoWindowArray:[],infoBubbleArray:[]},this.loadStatus=!1;var h={url:"http://maps.google.cn/maps/api/js",test:!1,version:"3.exp",key:"",libraries:"places",success:function(){},sensor:!1},b=b||{};if(b=o.fn.extendMine(h,b),b.target&&b.center&&b.zoom)if("google"in a)g.moveOptions.mapName=o.fn.common.createMap(b),o.fn.data(b.target,m.mapName,g.moveOptions.mapName),g.onMapLoad&&g.onMapLoad.call(g,g.moveOptions.mapName),b.success&&b.success.call(g,g.moveOptions.mapName),g.loadStatus=!0;else{var j=d(b);j.requireJs(function(a){g.moveOptions.mapName=o.fn.common.createMap(b),o.fn.data(a,m.mapName,g.moveOptions.mapName),g.onMapLoad&&g.onMapLoad.call(g,g.moveOptions.mapName),b.success&&b.success.call(g,g.moveOptions.mapName),g.loadStatus=!0},b.target)}return this.moveOptions.options=b,this.moveOptions.target=b.target,this.getLoadStatus=function(){return g.loadStatus},this.onMapLoad=function(a){},this.setCenter=function(a){var b=this,c=arguments[1]||"";if(a)try{var d=new google.maps.Geocoder;d.geocode({address:a},function(a,d){if(d==google.maps.GeocoderStatus.OK){var e=a[0].geometry.location,f=e.lat()+","+e.lng(),g=o.fn.common.makeGoogleLag(f);b.moveOptions.mapName.setCenter(g),b.moveOptions.centerCoor=f,c&&c.call(a,f)}else c.call(a,"")})}catch(e){}},this.setZoom=function(a){this.moveOptions.mapName.setZoom(a)},this.version="1.0.0",this.author="zhangjinglin",this.getMap=function(){return this.moveOptions.mapName},this.getTarget=function(){return this.moveOptions.target},this.setMarker=function(a){for(var b=0,c=this.moveOptions.mapName,d=this.moveOptions.target,e=[];b<a.length;b++){var f=o.fn.common.makeGoogleLag(a[b].position),g={position:f,map:c};a[b].icon&&(g.icon=a[b].icon),a[b].shape&&(g.shape=a[b].shape),a[b].title&&(g.title=a[b].title),a[b].zIndex&&(g.zIndex=a[b].zIndex),a[b].draggable&&(g.draggable=a[b].draggable),a[b].clickable&&(g.clickable=a[b].clickable),a[b].cursor&&(g.cursor=a[b].cursor),a[b].label&&(g.label=a[b].label);var h=new google.maps.Marker(g);e.push(h),this.moveOptions.markerArray.push(h),a[b].success&&a[b].success.call(h)}return o.fn.data(d,m.mapMarkerArray,e),e},this.getMarker=function(){return this.moveOptions.markerArray},this.setBounds=function(a){var b=new google.maps.LatLngBounds,c=[];c=a?a:this.moveOptions.markerArray,o.fn.each(c,function(a,c){b.extend(c.getPosition())}),this.moveOptions.mapName.fitBounds(b),this.moveOptions.mapName.panToBounds(b)},this.removeMarker=function(a){for(var b=a||this.moveOptions.markerArray||[],c=0;c<b.length;c++)b[c].setMap(null),o.fn.each(_markEvent,function(a,d){google.maps.event.clearListeners(b[c],d)});a||(this.moveOptions.markerArray=[])},this.getConfig=function(){return this.moveOptions.options},this.clear=function(){var a=this;a.moveOptions.markerArray&&a.removeMarker(),a.moveOptions.infoWindowArray.length>0&&a.removeInfo(),a.moveOptions.infoBubbleArray.length>0&&a.removeInfoBubble(),a.moveOptions.polylinesName&&a.clearPolylines()},this.resizeMap=function(){setTimeout(function(){var a=this.moveOptions.target;google.maps.event.trigger(a,"resize")},100)},this.direction=function(b){var c=this;if("google"in a)e.call(c,b);else{var f=d({});f.requireJs(function(a){e.call(c,b)}),this.moveOptions.loadGoole=!0}},this.getDirectionDisplay=function(){return this.moveOptions.directionsDisplay},this.getDirectionsService=function(){return this.moveOptions.directionsService},this.getDirectionResponse=function(){return this.moveOptions.response},this.removeDirection=function(){this.moveOptions.directionsDisplay.setMap(null)},this.setInfo=function(a){var b=this,c=!0,d="click",e=function(){},f={};a.content&&(f.content=a.content),a.maxWidth&&(f.maxWidth=a.maxWidth),a.pixelOffset&&(f.pixelOffset=a.pixelOffset),a.position&&(f.position=o.fn.common.makeGoogleLag(a.position)),a.zIndex&&(f.zIndex=a.zIndex),a.clickShow&&(c=a.clickShow),a.clickEvent&&(d=a.clickEvent),a.clickFn&&(e=a.clickFn);var g=new google.maps.InfoWindow(f);return a.position||c?a.marker.addListener(d,function(){e.call(a.marker,b.moveOptions.mapName),g.open(b.moveOptions.mapName,a.marker)},!1):g.open(b.moveOptions.mapName,a.marker),a.success&&a.success.call(this,g,b.moveOptions.mapName,a.marker),b.moveOptions.infoWindowArray.push(g),g},this.getInfo=function(){return this.moveOptions.infoWindowArray},this.removeInfo=function(a){a?a.close():(o.fn.each(this.moveOptions.infoWindowArray,function(a,b){b.close()}),this.moveOptions.infoWindowArray=[])},this.autoSearch=function(a){if(!a)throw"search area must be an elementHtml,better is input";new google.maps.places.Autocomplete(a)},this.infoBubble=function(b,c,e){function f(){function a(){g.moveOptions.infoBubbleArray.length>0&&(o.fn.each(g.moveOptions.infoBubbleArray,function(a,b){this.close()}),g.moveOptions.infoBubbleArray=[])}o.fn.each(j,function(c,d){var e=d;google.maps.event.addListener(e,"mouseup",function(){a();var c=new InfoBubble({map:g.moveOptions.mapName,content:b,shadowStyle:1,padding:0,backgroundColor:"#f3f5f6",borderRadius:5,arrowSize:10,borderWidth:1,borderColor:"#8f9aac",disableAutoPan:!1,hideCloseButton:!0,arrowPosition:30,arrowStyle:1});c.open(g.moveOptions.mapName,e),g.moveOptions.infoBubbleArray.push(c)})}),google.maps.event.addListener(g.moveOptions.mapName,"mouseup",function(){a()}),k.call(this)}var g=this,h=arguments[1],j=g.moveOptions.markerArray||[],k=e||function(){},b=b||"";if(!b)throw"HTML elements required!";if("[object Function]"===i.call(h)&&(k=h),"[object Array]"===i.call(h)&&(j=h),"InfoBubble"in a)f();else{var m=d(),n=l+"plugin/infobubble.js";m.requirePlugin(n,function(){f()})}},this.setInfoBubble=function(b){function c(){var a=new InfoBubble({map:f.moveOptions.mapName,content:i,shadowStyle:1,padding:b.padding,backgroundColor:"#f3f5f6",borderRadius:b.borderRadius,arrowSize:10,borderWidth:b.borderWidth,borderColor:b.borderColor,disableAutoPan:!1,hideCloseButton:!0,arrowPosition:b.arrowPosition,arrowStyle:b.arrowStyle});return a.open(f.moveOptions.mapName,g),f.moveOptions.infoBubbleArray.push(a),h.call(this,a,f.moveOptions.mapName,g),a}var e={html:"",mark:{},arrowStyle:3,borderRadius:0,borderWidth:1,borderColor:"#000000",padding:0,arrowPosition:30,success:function(){}},b=o.fn.extend(e,b),f=this,g=b.mark,h=b.success||function(){},i=b.html||"";if(!i)throw"HTML elements required!";if("InfoBubble"in a)return c();var j=d(),k=l+"plugin/infobubble.js";j.requirePlugin(k,function(){return c()})},this.getInfoBubble=function(){return this.moveOptions.infoBubbleArray},this.removeInfoBubble=function(a){a?a.close():($.each(this.moveOptions.infoBubbleArray,function(a,b){b.close()}),this.moveOptions.infoBubbleArray=[])},this.polylines=function(a){for(var b=this,c={path:[],geodesic:!0,strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:2,map:b.moveOptions.mapName},a=o.fn.extendMine(c,a),d=[],e=0;e<a.path.length;e++){var f=a.path[e],g=o.fn.common.makeGoogleLag(f);d.push(g)}a.path=d;var h=new google.maps.Polyline(a);return b.moveOptions.polylinesName=h,h},this.getPolyLines=function(){return this.moveOptions.polylinesName},this.clearPolylines=function(){this.moveOptions.polylinesName&&(this.moveOptions.polylinesName.setMap(null),this.moveOptions.polylinesName="")},this.print=function(b,c){function e(b,c){var b=b||g.moveOptions.options.target;if(!b)return!1;var d=a.open();d.document.write("<html><head><title>title</title>");for(var e=f.querySelectorAll("link"),h=0;h<e.length;h++)"stylesheet"==e[h].getAttribute("rel")&&d.document.write(e[h].outerHTML);d.document.write('<style>@media print{@page{size:landscape}*{box-shadow:none!important;}}</style></head><body><div id="mapWarp"></div></body></html>');var i=(d.document.body,d.document.querySelector("#mapWarp"));i.style.width=b.offsetWidth,i.style.height=b.offsetHeight,html2canvas(b,{useCORS:!0,onrendered:function(a){i.innerHTML='<img src="'+a.toDataURL("image/png")+'" />',d.print(),setTimeout(function(){d.close()},1e3)}})}var g=this;if("html2canvas"in a)e(b,c);else{var h=d(),i=l+"plugin/html2canvas/build/html2canvas.js";h.requirePlugin(i,function(){e(b,c)})}},this.dymPrint=function(b){var d=this,e=this.moveOptions.options.target,g=a.open();g.document.write("<html><head><title>Map</title>");for(var h=f.querySelectorAll("link"),i=0;i<h.length;i++)"stylesheet"==h[i].getAttribute("rel")&&g.document.write(h[i].outerHTML);g.document.write('<style>@media print{@page{size:landscape}*{box-shadow:none!important;}}</style></head><body><div id="mapWarp"></div></body></html>');var j=(g.document.body,g.document.querySelector("#mapWarp"));j.style.width=e.offsetWidth,j.style.height=e.offsetHeight;var k=this.getMap(),l=this.getCenter(),m=c({target:j,zoom:k.getZoom(),center:l,mapTypeId:k.getMapTypeId(),mapTypeControl:!1,zoomControl:!1,scaleControl:!1,panControl:!1,overviewMapControl:!1,streetViewControl:!1,scrollwheel:!1,success:function(){var a=d.getMarker(),b=d.getInfoBubble(),c=d.getPolyLines(),e=d.getInfo(),f=this.getDirectionDisplay();if(a.length>0&&a.forEach(function(a){a.setMap(m.getMap())}),b.length>0&&b.forEach(function(a){a.infoBubble.open(m.getMap(),a.marker)}),c&&c.setMap(m.getMap()),e.length>0&&e.forEach(function(a){a.infoWindow.open(m.getMap(),a.marker)}),f){var g=f.getDirections();f.setMap(m.getMap()),f.setDirections(g)}}})},this}function d(b){var c={url:"http://maps.google.cn/maps/api/js",test:!1,version:"3.exp",key:"",libraries:"places",success:function(){},sensor:!1},b=o.fn.extendMine(c,b);return{requireJs:function(c,d){if(q.push({fn:c,arg:d}),p)return!1;a.recallback=function(){for(;q.length>0;){var a=q.shift();a.fn.call(this,a.arg)}};var e=b.url;b.version&&(e+="?v="+b.version+"&"),b.key&&(e+="key="+b.key+"&"),b.libraries&&(e+="libraries="+b.libraries+"&"),e+="sensor="+b.sensor,e+="&callback=recallback";var g=f.createElement("script");g.type="text/javascript",g.loaded=!1,g.src=e,f.getElementsByTagName("head")[0].appendChild(g),p=!0},requirePlugin:function(a,b){e(a,b)},register:function(){}}}function e(a,b){var c=f.createElement("script");c.type="text/javascript",c.loaded=!1,c.src=a,c.onload=function(){c.loaded=!0,b.call(this),c.onload=c.onreadystatechange=null},c.onreadystatechange=function(){"loaded"!==c.readyState&&"complete"!==c.readyState||c.loaded||(b.call(this),c.onload=c.onreadystatechange=null)},f.getElementsByTagName("head")[0].appendChild(c)}var f=a.document,g=(a.location,a.navigator,Array.prototype.push),h=Array.prototype.slice,i=(Array.prototype.indexOf,Object.prototype.toString),j=(Object.prototype.hasOwnProperty,String.prototype.trim,"gmap"+("1.0.0"+Math.random()).replace(/\D/g,"")),k=0xb745ad94d70e,l="./",m={mapName:"gmap_293781038948",mapFnName:"gmap_182731927391",mapMarkerArray:"gmap_38373619382"},n=["plugin/infobubble.js","plugin/html2canvas/build/html2canvas.js"];Function.prototype.method=function(a,b){return this.prototype[a]?void 0:(this.prototype[a]=b,this)};var o={fn:{cache:{},toArray:function(){return h.call(this)},push:g,sort:[].sort,splice:[].splice,extend:function(a,b){var c,d=Object.prototype.toString,e="[object Array]",f=b||{},g=a||{};for(c in g)g.hasOwnProperty(c)&&("object"!=typeof g[c]||f[c]?f[c]||(f[c]=g[c]):(f[c]=d.call(g[c])===e?[]:{},o.fn.extend(g[c],f[c])));return f},extendMine:function(a,b){var b=b||{},a=a||{};for(var c in b){var d=b[c];a!==d&&("[object Object]"===Object.prototype.toString.call(d)&&d.length>0?a[c]=arguments.callee(a[c]||{},d):"[object Array]"===Object.prototype.toString.call(d)?a[c]=arguments.callee(a[c]||[],d):a[c]=d)}return a},data:function(a,b,c){if(a){if(!c&&"object"==typeof name)for(var d in name)this.data(a,d,b[d]);var e=j,f=a.uniqueNumber?a.uniqueNumber:a[e];return f||(f=a.uniqueNumber?a.uniqueNumber:a[e]=++k),b&&!o.fn.cache[f]&&(o.fn.cache[f]={}),c&&(o.fn.cache[f][b]=c),b?o.fn.cache[f][b]:f}},removeDate:function(a,b){if(a){var c=a[j];if(b){if(o.fn.cache[c]){delete o.fn.cache[c][b],b="";for(b in o.fn.cache[c])break;b||this.removeDate(a,b)}}else{try{delete a[j]}catch(d){a.removeAttribute(j)}delete o.fn.cache[c]}}},each:function(a,b){for(var c=0,d=a.length;d>c;c++)b.call(a[c],c,a[c])}}};o.fn.common={createMap:function(a){var b={target:"",center:"39.9388838,116.3974589",zoom:8,draggable:!0,draggableCursor:"auto",keyboardShortcuts:!0,mapMaker:!1,mapTypeId:google.maps.MapTypeId.ROADMAP,maxZoom:"",minZoom:"",overviewMapControl:!0,panControl:!0,rotateControl:!0,scaleControl:!0,scrollwheel:!0,streetViewControl:!0,styles:[],tilt:0,zoomControl:!0},a=a||{};if(a=o.fn.extendMine(b,a),"string"==typeof a.zoom&&(a.zoom=parseInt(a.zoom)),0==a.target.length)throw"the selector element is empty";var c=new google.maps.Map(a.target,{center:o.fn.common.makeGoogleLag(a.center),zoom:a.zoom,draggable:a.draggable,draggableCursor:a.draggableCursor,keyboardShortcuts:a.keyboardShortcuts,mapTypeId:a.mapTypeId,maxZoom:a.maxZoom,minZoom:a.minZoom,overviewMapControl:a.overviewMapControl,panControl:a.panControl,rotateControl:a.rotateControl,scaleControl:a.scaleControl,scrollwheel:a.scrollwheel,streetViewControl:a.streetViewControl,styles:a.styles,tilt:a.tilt,zoomControl:a.zoomControl});return c},makeGoogleLag:function(a){var a=a||"",a=a.split(",");if(!a)throw"this lag or lng is not string";var b=parseFloat(a[0])||"",c=parseFloat(a[1])||"";return{lat:b,lng:c}}},o.fn.each(n,function(a,b){var c=l+b;e(c,function(){})});var p=!1,q=[];a.gmap=c}(window);